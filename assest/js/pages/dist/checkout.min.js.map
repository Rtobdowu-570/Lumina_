{"version":3,"sources":["checkout.js"],"names":["_pocketbase","require","getProductAddedToCart","shippingRate","data","orderContent","first","second","third","last","subtotal","shipping","tax","total","_args","arguments","regeneratorRuntime","async","_context","prev","next","length","undefined","awrap","getFullList","filter","concat","getCurrentUser","id","expand","sent","document","querySelector","innerHTML","forEach","pd","product","itemTotal","productData","price","quantity","name","toFixed","textContent","stop","isAuthenticated","window","displayUsername","user","userName","checkAuth","user_name","pb","authStore","model","clear","logOutBtn","addEventListener","logOut","href","querySelectorAll","multiTabs","tab","classList","contains","tabType","t","remove","add","option","feeValue","toLowerCase","o","goBack","location"],"mappings":"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","file":"checkout.min.js","sourcesContent":["import { pb, isAuthenticated } from '../api/pocketbase.js';\n\n\nasync function getProductAddedToCart(shippingRate = 0.001) {\n    const data = await pb.collection('cart').getFullList({\n        filter: `user = \"${getCurrentUser().id}\"`,\n        expand: 'product'\n    });\n\n    const orderContent = document.querySelector('.order-items');\n    const first = document.querySelector('.first');\n    const second = document.querySelector('.second');\n    const third = document.querySelector('.third');\n    const last = document.querySelector('.last');\n\n    let subtotal = 0;\n    let shipping = 0;\n    const TAX_RATE = 0.0005;\n\n    orderContent.innerHTML = '';\n    \n    data.forEach(pd => {\n        const productData = pd.expand.product;\n        const itemTotal = productData.price * pd.quantity;\n        subtotal += itemTotal;\n        shipping += productData.price * shippingRate * pd.quantity;\n\n        orderContent.innerHTML +=\n        `\n            <div class=\"order-item\">\n                <div class=\"item-info\">\n                    <span class=\"item-name\">${productData.name}</span>\n                    <span class=\"item-qty\">Qty: ${pd.quantity}</span>\n                </div>\n                <span class=\"item-price\">$${itemTotal.toFixed(2)}</span>\n            </div>\n        `\n    });\n\n    const tax = subtotal * TAX_RATE;\n    const total = subtotal + shipping + tax;\n\n    if (first) first.textContent = subtotal.toFixed(2);\n    if (second) second.textContent = shipping.toFixed(2);\n    if (third) third.textContent = tax.toFixed(2);\n    if (last) last.textContent = total.toFixed(2);\n}\n\nfunction checkAuth() {\n    if (!isAuthenticated()) {\n        window.location.href = '/public/auth/auth.html';\n    }\n}\n\nfunction displayUsername() {\n    const user =  getCurrentUser()\n    const userName = document.querySelector('.user-name');\n\n    if (isAuthenticated()) {\n      if(user.name) {\n        userName.textContent = user.name;\n      } else {\n        userName.textContent = user.user_name;\n      }\n    }\n    else {\n      userName.textContent = \"Guest\";\n}\n}\n\nfunction getCurrentUser() {\n    return pb.authStore.model;\n}\n\nfunction logOut() {\n    pb.authStore.clear(); \n    window.location.href = '/auth/login.html';\n}\n\ndocument.addEventListener('DOMContentLoaded',  () => {\n    checkAuth();\n    displayUsername();\n    getProductAddedToCart()\n});\n\nconst logOutBtn = document.querySelector('.log-out');\nlogOutBtn.addEventListener('click', () => {\n    logOut();\n});\n\nconst multiTabs = document.querySelectorAll('.payment-option, .shipping-option');\nmultiTabs.forEach(tab => {\n    tab.addEventListener('click', () => {\n        const tabType = tab.classList.contains('payment-option') ? 'payment-option' : 'shipping-option';\n        document.querySelectorAll('.' + tabType).forEach(t => t.classList.remove('active'));\n        tab.classList.add('active');\n    });\n});\n\nconst options = document.querySelectorAll('[data-fee]');\noptions.forEach(option => {\n    option.addEventListener('click', () => {\n        const feeValue = option.dataset.fee.toLowerCase();\n        document.querySelectorAll('[data-fee]').forEach(o => o.classList.remove('active'));\n        option.classList.add('active');\n        if(feeValue === 'standard') {\n           getProductAddedToCart(0.001);\n        } else if(feeValue === 'express') {\n            getProductAddedToCart(0.004);\n        } else if(feeValue === 'overnight') {\n            getProductAddedToCart(0.007);\n        }\n    })\n})\n\nconst goBack = document.querySelector('.return');\ngoBack.addEventListener('click', () => {\n    window.location.href = '/public/cart.html';\n})"]}