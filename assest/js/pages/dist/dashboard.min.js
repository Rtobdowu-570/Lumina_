"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.logOut=logOut,exports.getCurrentUser=getCurrentUser,exports.checkAuth=checkAuth,exports.displayUsername=displayUsername;var _pocketbase=require("../api/pocketbase.js");function checkAuth(){(0,_pocketbase.isAuthenticated)()||(window.location.href="/public/auth/auth.html")}function displayUsername(){var e=getCurrentUser(),t=document.querySelector(".user-name");(0,_pocketbase.isAuthenticated)()?e.name?t.textContent=e.name:t.textContent=e.user_name:t.textContent="Guest"}function getCurrentUser(){return _pocketbase.pb.authStore.model}function logOut(){_pocketbase.pb.authStore.clear(),window.location.href="/auth/login.html"}function displayUserData(){var t,a,n,s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if((0,_pocketbase.isAuthenticated)()){e.next=2;break}return e.abrupt("return");case 2:if(t=_pocketbase.pb.authStore.model?_pocketbase.pb.authStore.model.id:null){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,e.next=8,regeneratorRuntime.awrap(_pocketbase.pb.collection("users").getOne(t));case 8:a=e.sent,n='\n                <div class="stat-img">\n                    <img src="'.concat(a.avatar||"/assest/images/placeholder.jpg",'" alt="').concat(a.name||"",'" class="user-avatar stat"></div>\n                <div class="stat-content user-data">\n                    <div class="stat-value">').concat(a.name||"",' <span class="edit-profile-btn">\n                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#FF5C5C" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                    <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>\n                    </svg>\n                    </span></div>\n                    <div class="stat-label">').concat(a.email||"",'</div>\n                    <div class="stat-label">').concat(a.user_name||"","</div>\n                </div>"),(s=document.querySelector(".user-stats"))?s.innerHTML=n:console.warn("No container found for user data"),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(5),console.error("Failed to fetch current user:",e.t0);case 17:case"end":return e.stop()}},null,null,[[5,14]])}function getStatusHTML(e){var t="",a="";return a=e.delivered?(t="delivered","Delivered"):e.shipped?(t="shipped","Shipped"):e.successful?(t="delivered","Successful"):e.failed?(t="failed","Failed"):(t="processing","Processing"),'<span class="status-badge '.concat(t,'">').concat(a,"</span>")}function displayUserOrder(){var t,a,n,s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.querySelector(".orders-table"),getCurrentUser().id,e.next=4,regeneratorRuntime.awrap(_pocketbase.pb.collection("checkout").getFullList({filter:'user = "'.concat(getCurrentUser().id,'"')}));case 4:a=e.sent,n=document.createElement("div"),s=(new Date).getFullYear(),a.forEach(function(e){!0===e.delivered||!0===e.shipped||!0===e.successful||e.failed,n.className="table-row",n.innerHTML='\n        <div class="table-cell">#ORD-'.concat(s,"-").concat(e.id.slice(0,3).toUpperCase(),'</div>\n        <div class="table-cell">').concat(e.created.slice(0,10),'</div>\n        <div class="table-cell">').concat(e.items.length,' items</div>\n        <div class="table-cell">$').concat(e.total,'</div>\n        <div class="table-cell">').concat(getStatusHTML(e),'</div>\n        <div class="table-cell"><button class="view-btn">View</button></div>\n    ')}),t.appendChild(n);case 9:case"end":return e.stop()}})}document.addEventListener("DOMContentLoaded",function(){checkAuth(),displayUsername(),displayUserData(),displayUserOrder()});
//# sourceMappingURL=dashboard.min.js.map
