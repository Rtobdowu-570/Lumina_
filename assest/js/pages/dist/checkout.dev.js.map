{"version":3,"sources":["checkout.js"],"names":["getProductAddedToCart","shippingRate","pb","collection","getFullList","filter","getCurrentUser","id","expand","data","orderContent","document","querySelector","first","second","third","last","subtotal","shipping","TAX_RATE","innerHTML","forEach","pd","productData","product","itemTotal","price","quantity","name","toFixed","tax","total","textContent","checkAuth","window","location","href","displayUsername","user","userName","user_name","authStore","model","logOut","clear","addEventListener","logOutBtn","multiTabs","querySelectorAll","tab","tabType","classList","contains","t","remove","add","options","option","feeValue","dataset","fee","toLowerCase","o"],"mappings":"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","sourcesContent":["import { pb, isAuthenticated } from '../api/pocketbase.js';\n\n\nasync function getProductAddedToCart(shippingRate = 0.001) {\n    const data = await pb.collection('cart').getFullList({\n        filter: `user = \"${getCurrentUser().id}\"`,\n        expand: 'product'\n    });\n\n    const orderContent = document.querySelector('.order-items');\n    const first = document.querySelector('.first');\n    const second = document.querySelector('.second');\n    const third = document.querySelector('.third');\n    const last = document.querySelector('.last');\n\n    let subtotal = 0;\n    let shipping = 0;\n    const TAX_RATE = 0.0005;\n\n    orderContent.innerHTML = '';\n    \n    data.forEach(pd => {\n        const productData = pd.expand.product;\n        const itemTotal = productData.price * pd.quantity;\n        subtotal += itemTotal;\n        shipping += productData.price * shippingRate * pd.quantity;\n\n        orderContent.innerHTML +=\n        `\n            <div class=\"order-item\">\n                <div class=\"item-info\">\n                    <span class=\"item-name\">${productData.name}</span>\n                    <span class=\"item-qty\">Qty: ${pd.quantity}</span>\n                </div>\n                <span class=\"item-price\">$${itemTotal.toFixed(2)}</span>\n            </div>\n        `\n    });\n\n    const tax = subtotal * TAX_RATE;\n    const total = subtotal + shipping + tax;\n\n    if (first) first.textContent = subtotal.toFixed(2);\n    if (second) second.textContent = shipping.toFixed(2);\n    if (third) third.textContent = tax.toFixed(2);\n    if (last) last.textContent = total.toFixed(2);\n}\n\nfunction checkAuth() {\n    if (!isAuthenticated()) {\n        window.location.href = '/public/auth/auth.html';\n    }\n}\n\nfunction displayUsername() {\n    const user =  getCurrentUser()\n    const userName = document.querySelector('.user-name');\n\n    if (isAuthenticated()) {\n      if(user.name) {\n        userName.textContent = user.name;\n      } else {\n        userName.textContent = user.user_name;\n      }\n    }\n    else {\n      userName.textContent = \"Guest\";\n}\n}\n\nfunction getCurrentUser() {\n    return pb.authStore.model;\n}\n\nfunction logOut() {\n    pb.authStore.clear(); \n    window.location.href = '/auth/login.html';\n}\n\ndocument.addEventListener('DOMContentLoaded',  () => {\n    checkAuth();\n    displayUsername();\n    getProductAddedToCart()\n});\n\nconst logOutBtn = document.querySelector('.log-out');\nlogOutBtn.addEventListener('click', () => {\n    logOut();\n});\n\nconst multiTabs = document.querySelectorAll('.payment-option, .shipping-option');\nmultiTabs.forEach(tab => {\n    tab.addEventListener('click', () => {\n        const tabType = tab.classList.contains('payment-option') ? 'payment-option' : 'shipping-option';\n        document.querySelectorAll('.' + tabType).forEach(t => t.classList.remove('active'));\n        tab.classList.add('active');\n    });\n});\n\nconst options = document.querySelectorAll('[data-fee]');\noptions.forEach(option => {\n    option.addEventListener('click', () => {\n        const feeValue = option.dataset.fee.toLowerCase();\n        document.querySelectorAll('[data-fee]').forEach(o => o.classList.remove('active'));\n        option.classList.add('active');\n        if(feeValue === 'standard') {\n           getProductAddedToCart(0.001);\n        } else if(feeValue === 'express') {\n            getProductAddedToCart(0.004);\n        } else if(feeValue === 'overnight') {\n            getProductAddedToCart(0.007);\n        }\n    })\n})"],"file":"checkout.dev.js"}